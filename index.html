<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Booster Global - Live Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/11.0.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.0.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore-compat.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap');
        
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #030405;
            color: #ffffff;
            overflow-x: hidden;
        }

        .video-aspect {
            aspect-ratio: 9 / 16;
            background: #000;
            border-radius: 24px;
            overflow: hidden;
            position: relative;
        }

        .glass-nav {
            background: rgba(10, 12, 15, 0.8);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .boost-card {
            background: #0d0f12;
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 32px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .boost-card:hover {
            border-color: #3b82f6;
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }

        /* Hide scrollbar but keep functionality */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="min-h-screen">

    <!-- Entry Interaction Overlay -->
    <div id="entryOverlay" class="fixed inset-0 z-[1000] bg-black flex flex-col items-center justify-center p-6 text-center">
        <div class="mb-8 w-24 h-24 bg-blue-600 rounded-full flex items-center justify-center animate-bounce shadow-[0_0_50px_rgba(37,99,235,0.4)]">
            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="white"><path d="m7 4 12 8-12 8V4z"/></svg>
        </div>
        <h1 class="text-4xl font-extrabold mb-4">Social Booster Hub</h1>
        <p class="text-slate-400 max-w-sm mb-10">Click below to start the autoplay engine and boost community views.</p>
        <button onclick="unlockApp()" class="bg-blue-600 hover:bg-blue-500 text-white px-12 py-4 rounded-2xl font-bold text-xl transition-all shadow-xl shadow-blue-600/20">
            LAUNCH ENGINE
        </button>
    </div>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 glass-nav px-6 py-4 flex justify-between items-center">
        <div class="flex items-center gap-2">
            <div class="w-10 h-10 bg-gradient-to-tr from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center font-black">B</div>
            <h1 class="text-xl font-bold hidden md:block">BOOST<span class="text-blue-500">PRO</span></h1>
        </div>

        <div class="flex bg-white/5 p-1 rounded-2xl border border-white/5 gap-1 no-scrollbar overflow-x-auto">
            <button onclick="filter('all')" class="tab-btn active bg-blue-600 text-white px-5 py-2 rounded-xl text-xs font-bold uppercase transition-all">All</button>
            <button onclick="filter('youtube')" class="tab-btn text-slate-500 px-5 py-2 rounded-xl text-xs font-bold uppercase transition-all hover:text-white">YT</button>
            <button onclick="filter('tiktok')" class="tab-btn text-slate-500 px-5 py-2 rounded-xl text-xs font-bold uppercase transition-all hover:text-white">TT</button>
            <button onclick="filter('instagram')" class="tab-btn text-slate-500 px-5 py-2 rounded-xl text-xs font-bold uppercase transition-all hover:text-white">IG</button>
            <button onclick="filter('facebook')" class="tab-btn text-slate-500 px-5 py-2 rounded-xl text-xs font-bold uppercase transition-all hover:text-white">FB</button>
        </div>

        <button onclick="openAdmin()" class="p-3 bg-white/5 rounded-2xl hover:bg-white/10 transition-all">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>
        </button>
    </nav>

    <!-- Content Grid -->
    <main class="pt-28 pb-20 px-6 max-w-7xl mx-auto">
        <div id="videoGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
            <!-- Videos injected here -->
        </div>
    </main>

    <!-- Admin Panel -->
    <div id="adminPanel" class="fixed inset-0 z-[100] bg-black/95 backdrop-blur-md hidden flex items-center justify-center p-4">
        <div class="bg-[#0d0f12] w-full max-w-lg rounded-[2.5rem] border border-white/10 shadow-2xl overflow-hidden">
            <div class="p-8 border-b border-white/5 flex justify-between items-center">
                <h2 class="text-2xl font-bold">Admin Hub</h2>
                <button onclick="closeAdmin()" class="text-slate-500 hover:text-white text-2xl">✕</button>
            </div>
            <div class="p-8 space-y-6">
                <div class="grid grid-cols-4 gap-2" id="platformChoice">
                    <button onclick="setPlatform('youtube')" class="plt-btn active bg-blue-600 p-2 rounded-lg text-[10px] font-bold uppercase">YT</button>
                    <button onclick="setPlatform('tiktok')" class="plt-btn bg-white/5 p-2 rounded-lg text-[10px] font-bold uppercase">TT</button>
                    <button onclick="setPlatform('instagram')" class="plt-btn bg-white/5 p-2 rounded-lg text-[10px] font-bold uppercase">IG</button>
                    <button onclick="setPlatform('facebook')" class="plt-btn bg-white/5 p-2 rounded-lg text-[10px] font-bold uppercase">FB</button>
                </div>
                <input type="text" id="urlInput" placeholder="Paste Video URL..." class="w-full bg-black border border-white/10 p-4 rounded-2xl outline-none focus:border-blue-500">
                <input type="text" id="creatorInput" placeholder="Creator Name" class="w-full bg-black border border-white/10 p-4 rounded-2xl outline-none focus:border-blue-500">
                <button onclick="addVideo()" class="w-full bg-blue-600 py-4 rounded-2xl font-bold hover:bg-blue-500 transition-all shadow-xl shadow-blue-600/20">
                    PUSH TO FEED
                </button>
            </div>
            <div id="liveList" class="p-8 bg-black/40 border-t border-white/5 max-h-40 overflow-y-auto">
                <!-- Manage list -->
            </div>
        </div>
    </div>

    <script>
        // --- 1. Configuration & Initialization ---
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'global-booster-v1';
        
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        let currentTab = 'all';
        let selectedPlatform = 'youtube';
        let videos = [];

        // --- 2. Smart Extraction Engine ---
        function extractID(url, platform) {
            try {
                const u = url.trim();
                if (platform === 'youtube') {
                    if (u.includes('shorts/')) return u.split('shorts/')[1].split(/[?#&]/)[0];
                    if (u.includes('v=')) return u.split('v=')[1].split(/[?#&]/)[0];
                    if (u.includes('youtu.be/')) return u.split('youtu.be/')[1].split(/[?#&]/)[0];
                } else if (platform === 'tiktok') {
                    return u.split('/video/')[1]?.split(/[?#&]/)[0] || u.split('/').pop().split(/[?#&]/)[0];
                } else if (platform === 'instagram') {
                    return u.split('/reel/')[1]?.split('/')[0] || u.split('/p/')[1]?.split('/')[0];
                } else if (platform === 'facebook') {
                    return u.split('/reel/')[1]?.split(/[/?#&]/)[0];
                }
                return u;
            } catch(e) { return url; }
        }

        function getEmbed(v) {
            const id = v.videoId;
            if (v.platform === 'youtube') return `https://www.youtube.com/embed/${id}?autoplay=1&mute=1&loop=1&playlist=${id}`;
            if (v.platform === 'tiktok') return `https://www.tiktok.com/embed/v2/${id}`;
            if (v.platform === 'instagram') return `https://www.instagram.com/reel/${id}/embed/`;
            if (v.platform === 'facebook') return `https://www.facebook.com/plugins/video.php?href=https://www.facebook.com/reel/${id}/&show_text=0&autoplay=true`;
        }

        // --- 3. Core Logic ---
        async function unlockApp() {
            try {
                await auth.signInAnonymously();
                document.getElementById('entryOverlay').style.display = 'none';
                startListener();
            } catch (e) { alert("Error connecting to hub."); }
        }

        function startListener() {
            // Path: /artifacts/{appId}/public/data/videos
            db.collection('artifacts').doc(appId).collection('public').doc('data').collection('videos')
              .onSnapshot(snap => {
                  videos = snap.docs.map(doc => ({id: doc.id, ...doc.data()}));
                  render();
              });
        }

        function render() {
            const grid = document.getElementById('videoGrid');
            const filtered = currentTab === 'all' ? videos : videos.filter(v => v.platform === currentTab);
            
            grid.innerHTML = filtered.map(v => `
                <div class="boost-card p-4 space-y-4">
                    <div class="video-aspect">
                        <iframe src="${getEmbed(v)}" class="w-full h-full border-0" allow="autoplay; encrypted-media"></iframe>
                    </div>
                    <div class="px-2">
                        <div class="flex justify-between items-center mb-4">
                            <span class="font-bold text-sm truncate w-2/3">${v.creator}</span>
                            <span class="text-[10px] bg-blue-600 px-2 py-0.5 rounded font-bold uppercase">${v.platform.slice(0,2)}</span>
                        </div>
                        <div class="grid grid-cols-3 gap-2">
                            <button onclick="handleBoost('${v.id}', 'likes', '${v.originalUrl}')" class="flex flex-col items-center py-2 bg-white/5 rounded-xl hover:bg-red-500/10 transition-all">
                                <span class="text-xs">❤️</span>
                                <span class="text-[9px] font-bold mt-1">${v.likes || 0}</span>
                            </button>
                            <button onclick="handleBoost('${v.id}', 'follows', '${v.originalUrl}')" class="flex flex-col items-center py-2 bg-white/5 rounded-xl hover:bg-blue-500/10 transition-all">
                                <span class="text-xs">➕</span>
                                <span class="text-[9px] font-bold mt-1">${v.follows || 0}</span>
                            </button>
                            <button onclick="handleBoost('${v.id}', 'views', '')" class="flex flex-col items-center py-2 bg-white/5 rounded-xl hover:bg-yellow-500/10 transition-all">
                                <span class="text-xs">⚡</span>
                                <span class="text-[9px] font-bold mt-1">${v.views || 0}</span>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');

            const list = document.getElementById('liveList');
            list.innerHTML = videos.map(v => `
                <div class="flex justify-between items-center text-xs p-2 border-b border-white/5">
                    <span>${v.creator}</span>
                    <button onclick="deleteVideo('${v.id}')" class="text-red-500">Delete</button>
                </div>
            `).join('');
        }

        async function handleBoost(id, type, url) {
            const ref = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('videos').doc(id);
            await ref.update({ [type]: firebase.firestore.FieldValue.increment(1), views: firebase.firestore.FieldValue.increment(1) });
            if(url) window.open(url, '_blank');
        }

        async function addVideo() {
            const url = document.getElementById('urlInput').value;
            const creator = document.getElementById('creatorInput').value;
            if(!url || !creator) return;

            const videoId = extractID(url, selectedPlatform);
            await db.collection('artifacts').doc(appId).collection('public').doc('data').collection('videos').add({
                platform: selectedPlatform,
                creator: creator,
                videoId: videoId,
                originalUrl: url,
                likes: 0,
                follows: 0,
                views: 0,
                createdAt: Date.now()
            });

            document.getElementById('urlInput').value = '';
            document.getElementById('creatorInput').value = '';
        }

        async function deleteVideo(id) {
            await db.collection('artifacts').doc(appId).collection('public').doc('data').collection('videos').doc(id).delete();
        }

        // --- UI State ---
        function filter(f) {
            currentTab = f;
            document.querySelectorAll('.tab-btn').forEach(b => {
                b.classList.remove('bg-blue-600', 'text-white');
                b.classList.add('text-slate-500');
            });
            event.target.classList.add('bg-blue-600', 'text-white');
            render();
        }

        function setPlatform(p) {
            selectedPlatform = p;
            document.querySelectorAll('.plt-btn').forEach(b => b.classList.remove('active', 'bg-blue-600'));
            event.target.classList.add('active', 'bg-blue-600');
        }

        function openAdmin() { document.getElementById('adminPanel').classList.remove('hidden'); }
        function closeAdmin() { document.getElementById('adminPanel').classList.add('hidden'); }

    </script>
</body>
</html>